---
import Header from "@components/Header.astro";
import ArtifactModal from "@components/ArtifactModal.astro";
import { siteContext } from "../data/context";
---

<Header />
<div class="min-h-screen bg-gradient-to-b from-blue-900 via-cyan-900 to-slate-900 text-white flex items-center justify-center">
  <div class="glass-layer w-full max-w-5xl mx-auto px-2 sm:px-6 py-6 sm:py-12 space-y-8 sm:space-y-12">
    <!-- Hero Panel -->
    <div class="glass-panel text-center mt-24"
      x-data="{commits: $astro.props.stats.commits, artifacts: $astro.props.stats.artifacts, lastSync: '$astro.props.stats.lastSync', loading: false, tick: Date.now(), refresh() { this.loading = true; setTimeout(() => { this.commits += 1; this.artifacts += 1; this.lastSync = new Date().toISOString().slice(0,10); this.loading = false; }, 800); }, init() { if (window.mkptriTick) { window.mkptriTick.subscribe(v => this.tick = v); } } }"
      x-init="init()"
      :stats="siteContext.stats"
    >
      <h1 class="text-5xl font-bold mb-6">{siteContext.hero.home.heading}</h1>
      <p class="text-xl mb-8">{siteContext.hero.home.subheading}</p>
      <div class="grid grid-cols-1 sm:grid-cols-3 gap-2 sm:gap-4 text-base sm:text-lg mb-2 sm:mb-4">
        <div>Commits: <span x-text="commits"></span></div>
        <div>Last Sync: <span x-text="lastSync"></span></div>
        <div>Artifacts: <span x-text="artifacts"></span></div>
        <div class="col-span-1 sm:col-span-3 text-xs text-cyan-300 mt-2">Tick: <span x-text="new Date(tick).toLocaleTimeString()"></span></div>
      </div>
      <button @click="refresh" :disabled="loading" class="mt-2 px-3 py-2 sm:px-4 rounded bg-cyan-600 hover:bg-cyan-500 transition text-white font-mono text-xs sm:text-sm disabled:opacity-50">
        <span x-show="!loading">Refresh Stats</span>
        <span x-show="loading" class="animate-pulse">Refreshing...</span>
      </button>
    </div>

    <!-- Sub-Dashboard Cards (Flowbite Cards) -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6">
      <a href="/operations/" class="glass-panel p-3 sm:p-6 hover:scale-105 transition-transform">
        <h3 class="text-2xl mb-2">Operations Terminal</h3>
        <p>Run stubs, view pipelines.</p>
      </a>
      <a href="/gallery/" class="glass-panel p-6 hover:scale-105 transition-transform">
        <h3 class="text-2xl mb-2">Gallery Dashboard</h3>
        <p>Filter & view 12+ artifacts.</p>
        <div class="mt-4"><ArtifactModal /></div>
      </a>
      <a href="/transparency/" class="glass-panel p-6 hover:scale-105 transition-transform">
        <h3 class="text-2xl mb-2">Transparency Dashboard</h3>
        <p>Provenance, CI/CD, commit graph.</p>
      </a>
      <a href="/omni/" class="glass-panel p-6 hover:scale-105 transition-transform">
        <h3 class="text-2xl mb-2">Omni Dashboard</h3>
        <p>Ingress ideas via LLM Engine.</p>
      </a>
      <a href="/codex/" class="glass-panel p-6 hover:scale-105 transition-transform">
        <h3 class="text-2xl mb-2">Codex Dashboard</h3>
        <p>Cycles, artifacts, checkpoints.</p>
      </a>
    </div>

    <!-- Quick Sections Panel -->
    <div class="glass-panel">
      <h2 class="text-3xl mb-6">Core Pillars</h2>
      <div class="grid md:grid-cols-3 gap-8">
        <div><h3 class="text-xl">Codex</h3><p>Chronological ceremonies, artifacts, checkpoints.</p></div>
        <div><h3 class="text-xl">Omni</h3><p>Idea ingress, mythic systems, AI console.</p></div>
        <div><h3 class="text-xl">Transparency</h3><p>Deployment state, provenance, CI/CD lineage.</p></div>
      </div>
    </div>

    <!-- Featured Artifacts Stack -->
    <div class="glass-panel">
      <h2 class="text-3xl mb-6">Featured Artifacts</h2>
      <div class="space-y-6">
        <div class="bg-white/5 p-6 rounded-xl">Cycle Alpha: Genesis of the Codex – A ceremonial blueprint for inspectable architecture.</div>
        <div class="bg-white/5 p-6 rounded-xl">Cycle Beta: Edge Worker Ceremony – Binding edge logic to sovereign transparency.</div>
        <div class="bg-white/5 p-6 rounded-xl">Cycle Gamma: Mythic Sync – Synchronizing mythic state with verifiable checkpoints.</div>
      </div>
    </div>

    <!-- Latest Updates Panel -->
    <div class="glass-panel">
      <h2 class="text-3xl mb-6">Latest Updates</h2>
      <ul class="space-y-4">
        <li>• Gallery Expansion – #visual #artifacts</li>
        <li>• Omni Console Launched – #ai #console</li>
        <li>• Codex Birth – #genesis #archive</li>
      </ul>
    </div>

    <!-- About Panel -->
    <div class="glass-panel">
      <h2 class="text-3xl mb-6">About MKP-TRI</h2>
      <p>In the ether of digital sovereignty, MKP-TRI emerges as a beacon for mythic operations. Every cycle, ceremony, and artifact is bound to a verifiable checkpoint, ensuring eternal inspectability. The Living Codex is not just a record—it's a living, breathing archive of creation, where AI, art, and transparency converge. From the genesis of the Codex to the latest edge worker deployments, each event is a sovereign act, witnessed and preserved. Join the journey—explore, inspect, and contribute to the mythic evolution of MKP-TRI.</p>
    </div>
  </div>
</div>
